import * as R from "ramda";
import {ADD_PRODUCT_TO_BASKET, CLEAN_BASKET, REMOVE_ITEM_FROM_BASKET, REMOVE_PRODUCT_FROM_BASKET} from "./actionTypes";


export const getBasketProductsWithCount = state => {
    const products = R.uniq(state)
    return products
};

export const countOfProduct = (product, state) => {
    let count = 0;
    state.forEach(item => {
       if(item.id === product.id){
           count++
       }
    })
    product.count = count;
    return count;
}

export const productSubPrice = (product, state) => {
    let count = 0;
    state.forEach(item => {
        if(item.id === product.id){
            count += product.price
        }
    })
    product.subprice = count;
    return count
}

export const getTotalPrice = (state) => {

    let count = 0
    state.forEach(item => count+= item.price)
    return count

}

export const getUniqProducts = products => {
    const newProducts = R.uniq(products)
    return newProducts;
}


//добавляем товар в корзину
export const addProductToBasket = (product, dispatch) => {
    dispatch({type: ADD_PRODUCT_TO_BASKET, payload: product})
};


//удаляем товар из корзины
export const removeProductFromBasket = (product, dispatch) => {
    dispatch({type: REMOVE_PRODUCT_FROM_BASKET, payload: product})
}

export const removeItemFromBasket = (product, dispatch) => {
    dispatch({type: REMOVE_ITEM_FROM_BASKET, payload: product})
}

export const cleanBasket = ( dispatch) => {
    dispatch({type: CLEAN_BASKET})
}


export const filterProductsSearch = (searchState, products) => {
    if(searchState === ''){
        return products
    }
    const newValues = []
    products.forEach(item => {
       if( item.name.toLowerCase().includes(searchState.toLowerCase())){
           newValues.push(item)
       }
    })
    return newValues
}

export const getIds = (state) => {
    const ids = []
    state.forEach(item => ids.push(item.id))
    return ids;
}

export const parseStringToArray = string => {
    if(!string){
        return
    }

    const array =  string.split(',');


    return array;
};

