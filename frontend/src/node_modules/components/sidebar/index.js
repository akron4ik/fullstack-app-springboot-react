import React, { useEffect, useState} from "react";
import {Link} from "react-router-dom";

import useFetch from "hooks/useFetch";


/**
 * Компонент в котором рендерим категории, которые приходят с сервера
 */
const Sidebar = () => {

    const apiCategories = '/rest/categories'
    const [{response, isLoading}, doFetch] = useFetch(apiCategories);
    const [categories, setCategories] = useState([])

    useEffect(()=>{
        doFetch()
    }, [doFetch])
    useEffect(()=>{
        if(!response){
            return
        }
        setCategories(response)
    }, [response])

    const renderCategory = (category, index) => {
        return (
            <li key={index}>
                <Link to={`/categories/${category.id}`}>{category.name} </Link>
            </li>
        )
    };

    return (
        <div className="col-md-3 col-sm-3 collection-sidebar">
            <div className="product-standard filter-product">
                <div className="filter filter-category">
                    <h3 className="filtertitle">
                        Категории
                    </h3>
                    <ul className="filter-content js-filter-menu">
                        <li><a href="/">Всё</a></li>
                        { !isLoading && categories.map((category, index) => renderCategory(category, index))}
                    </ul>
                </div>

                <div className="sidebar-banner">
                </div>
            </div>
        </div>
    )

}


export default Sidebar